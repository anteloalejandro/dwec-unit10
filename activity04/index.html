<!DOCTYPE html>
<html lang=es>

<head>
  <meta charset=UTF-8>
  <meta name=viewport content=width=device-width, initial-scale=1.0>
  <meta http-equiv=X-UA-Compatible content=ie=edge>
  <title>Document</title>
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <h1>Conversi√≥n de monedas</h1>
  <form action="#">
    <table align="center">
      <tr>
        <td>
          <input type="number" id="cantidad" placeholder="Moneda base" size="4" style="text-align: right">
        </td>
        <td>
          <select name=moneda1 id=moneda1>
            <option>AUD</option>
            <option>BGN</option>
            <option>BRL</option>
            <option>CAD</option>
            <option>CHF</option>
            <option>CNY</option>
            <option>CZK</option>
            <option>DKK</option>
            <option selected>EUR</option>
            <option>GBP</option>
            <option>HKD</option>
            <option>HRK</option>
            <option>HUF</option>
            <option>IDR,</option>
            <option>INR</option>
            <option>ILS</option>
            <option>ISK</option>
            <option>KRW</option>
            <option>MXN</option>
            <option>JPY</option>
            <option>NOK</option>
            <option>NZD</option>
            <option>PHP</option>
            <option>PLN</option>
            <option>RON</option>
            <option>RUB</option>
            <option>SEK</option>
            <option>SGD</option>
            <option>THB</option>
            <option>TRY</option>
            <option>USD</option>
            <option>ZAR</option>
          </select>
        </td>
      </tr>
      <tr>
        <td>
          <label for="moneda2">Convertir a..</label>
        </td>
        <td>
          <select name=moneda2 id=moneda2>
            <option>AUD</option>
            <option>BGN</option>
            <option>BRL</option>
            <option>CAD</option>
            <option>CHF</option>
            <option>CNY</option>
            <option>CZK</option>
            <option>DKK</option>
            <option>EUR</option>
            <option selected>GBP</option>
            <option>HKD</option>
            <option>HRK</option>
            <option>HUF</option>
            <option>IDR,</option>
            <option>INR</option>
            <option>ILS</option>
            <option>ISK</option>
            <option>KRW</option>
            <option>MXN</option>
            <option>JPY</option>
            <option>NOK</option>
            <option>NZD</option>
            <option>PHP</option>
            <option>PLN</option>
            <option>RON</option>
            <option>RUB</option>
            <option>SEK</option>
            <option>SGD</option>
            <option>THB</option>
            <option>TRY</option>
            <option>USD</option>
            <option>ZAR</option>
          </select>
        </td>
      </tr>
    </table>
    <br><button type="submit">Convertir</button>
    <p><strong>Resultado: </strong><span id="resultado"></span></p>
  </form>
  <script type="module">

    // Function to handle the API request.
    async function procesarFetch(to, from, amount) {
      const headers = new Headers();
      headers.append("apikey", "goUdTZuPVV91wTFi9fcJuaVllxDojdFs")
      const conf = {
        method: "GET",
        refirect: "follow",
        headers: headers
      }
      try {
        const resp1 = await fetch(`https://api.apilayer.com/exchangerates_data/convert?to=${to}&from=${from}&amount=${amount}`, conf);
        const data = await resp1.json();
        console.log(data)
        return data
      }
      catch (error) {
        console.log(error);
        return error
      }
    }

    // Add an event to the form
    const form = document.querySelector('form')
    form.addEventListener('submit', ev => {
      // Stop page from reloading on submission
      ev.preventDefault()

      // Make the request with the data from the form as arguments.
      procesarFetch(
        document.getElementById('moneda2').value,
        document.getElementById('moneda1').value,
        document.getElementById('cantidad').value
      ).then(data => {
        // Print the 'result' attribute from the response.
        document.getElementById('resultado').textContent = data.result
      })
    })
  </script>
</body>

</html>
